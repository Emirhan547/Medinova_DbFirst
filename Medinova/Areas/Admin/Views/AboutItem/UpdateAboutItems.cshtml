@model Medinova.Models.AboutItem
@{
    ViewBag.Title = "UpdateAboutItems";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="space-y-6">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-2xl font-bold text-slate-900 dark:text-white">Hakkımızda Öğesini Düzenle</h1>
            <p class="text-slate-500 dark:text-slate-400 mt-1">Hakkımızda öğesi detaylarını güncelleyin</p>
        </div>
        <a href="@Url.Action("Index", "AboutItem", new { area = "Admin" })"
           class="text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white flex items-center gap-2 text-sm font-medium">
            <span class="material-symbols-outlined !text-lg">arrow_back</span>
            Listeye Dön
        </a>
    </div>

    <div class="bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6">
        <form method="post" action="@Url.Action("UpdateAboutItem", "AboutItem", new { area = "Admin", id = Model.AboutItemId })" class="space-y-6">
            @Html.AntiForgeryToken()
            @Html.HiddenFor(m => m.AboutItemId)

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Öğe Adı -->
                <div class="lg:col-span-2">
                    <label for="Name" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                        Öğe Adı <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="Name" name="Name" value="@Model.Name"
                           class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all"
                           placeholder="örn: 7/24 Destek, Uzman Doktorlar, Modern Ekipman"
                           required>
                </div>

                <!-- İkon Seçimi -->
                <div class="lg:col-span-2">
                    <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                        İkon Seçin <span class="text-slate-400 text-xs">(Opsiyonel)</span>
                    </label>

                    <!-- Seçilen İkon Önizleme -->
                    <div class="mb-4">
                        <div class="inline-flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600">
                            <div id="selectedIconPreview" class="p-2 rounded-lg bg-primary/10 text-primary @(string.IsNullOrEmpty(Model.Icon) ? "hidden" : "")">
                                <span class="material-symbols-outlined !text-2xl" id="iconPreview">@Model.Icon</span>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-slate-700 dark:text-slate-300">Seçilen İkon:</p>
                                <p class="text-sm text-slate-500 dark:text-slate-400" id="iconName">
                                    @(string.IsNullOrEmpty(Model.Icon) ? "İkon seçilmedi" : Model.Icon)
                                </p>
                                <input type="hidden" id="Icon" name="Icon" value="@Model.Icon">
                            </div>
                            <button type="button" onclick="clearIconSelection()"
                                    class="ml-auto p-1.5 text-slate-400 hover:text-red-500 transition-colors">
                                <span class="material-symbols-outlined !text-lg">close</span>
                            </button>
                        </div>
                    </div>

                    <!-- İkon Grid -->
                    <div class="grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 gap-3 max-h-60 overflow-y-auto p-3 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700">
                        @{
                            var popularIcons = new List<string>
                                                            {
                                "check_circle", "star", "thumb_up", "verified", "security",
                                "medical_services", "local_hospital", "medication", "healing",
                                "group", "person", "support_agent", "phone_in_talk",
                                "schedule", "timer", "event_available", "calendar_month",
                                "location_on", "pin_drop", "map", "navigation",
                                "credit_card", "payments", "price_check", "savings",
                                "wifi", "bolt", "water_drop", "thermostat",
                                "vaccines", "monitor_heart", "ecg_heart", "stethoscope",
                                "lab_profile", "science", "biotech", "psychology",
                                "ambulance", "emergency", "warning", "priority_high",
                                "restaurant", "local_cafe", "hotel", "bed",
                                "fitness_center", "sports", "self_improvement", "hiking",
                                "spa", "pool", "shower", "bathtub",
                                "clean_hands", "sanitizer", "soap", "wash"
                            };
                        }

                        @foreach (var icon in popularIcons)
                        {
                            <button type="button"
                                    onclick="selectIcon('@icon')"
                                    class="p-3 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:border-primary hover:bg-primary/5 dark:hover:bg-primary/10 transition-all flex flex-col items-center justify-center group @(icon == Model.Icon ? "border-primary bg-primary/10 dark:bg-primary/20" : "")">
                                <span class="material-symbols-outlined !text-xl text-slate-600 dark:text-slate-400 group-hover:text-primary @(icon == Model.Icon ? "text-primary" : "")">@icon</span>
                                <span class="text-[10px] text-slate-500 dark:text-slate-500 mt-1 truncate w-full text-center">@icon</span>
                            </button>
                        }
                    </div>

                    <!-- Özel İkon Girişi -->
                    <div class="mt-4">
                        <p class="text-sm text-slate-500 dark:text-slate-400 mb-2 text-center">Veya özel ikon adı girin</p>
                        <div class="flex gap-2">
                            <input type="text" id="customIconInput"
                                   class="flex-1 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all"
                                   placeholder="örn: check_circle, star, medical_services"
                                   value="@(string.IsNullOrEmpty(Model.Icon) || popularIcons.Contains(Model.Icon) ? "" : Model.Icon)">
                            <button type="button" onclick="useCustomIcon()"
                                    class="bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors">
                                Kullan
                            </button>
                        </div>
                        <p class="text-xs text-slate-400 dark:text-slate-500 mt-2">
                            Material Symbols ikon adlarını kullanın. İkonlara göz atmak için
                            <a href="https://fonts.google.com/icons" target="_blank" class="text-primary hover:underline">fonts.google.com/icons</a>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Form İşlemleri -->
            <div class="flex items-center justify-between pt-6 border-t border-slate-200 dark:border-slate-700">
                <a href="@Url.Action("Index", "AboutItem", new { area = "Admin" })"
                   class="px-5 py-2.5 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors">
                    İptal
                </a>
                <div class="flex items-center gap-3">
                    <button type="submit"
                            class="bg-primary hover:bg-primary/90 text-white px-6 py-2.5 rounded-lg text-sm font-semibold flex items-center gap-2 transition-colors">
                        <span class="material-symbols-outlined !text-lg">save</span>
                        Öğeyi Güncelle
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    function selectIcon(iconName) {
        document.getElementById('Icon').value = iconName;
        document.getElementById('iconPreview').textContent = iconName;
        document.getElementById('iconName').textContent = iconName;
        document.getElementById('selectedIconPreview').classList.remove('hidden');

        // Seçilen ikonu vurgula
        document.querySelectorAll('[onclick^="selectIcon"]').forEach(btn => {
            btn.classList.remove('border-primary', 'bg-primary/10', 'dark:bg-primary/20');
            if (btn.getAttribute('onclick').includes(`'${iconName}'`)) {
                btn.classList.add('border-primary', 'bg-primary/10', 'dark:bg-primary/20');
            }
        });
    }

    function clearIconSelection() {
        document.getElementById('Icon').value = '';
        document.getElementById('iconPreview').textContent = '';
        document.getElementById('iconName').textContent = 'İkon seçilmedi';
        document.getElementById('selectedIconPreview').classList.add('hidden');

        // Tüm ikonlardan vurgulamayı kaldır
        document.querySelectorAll('[onclick^="selectIcon"]').forEach(btn => {
            btn.classList.remove('border-primary', 'bg-primary/10', 'dark:bg-primary/20');
        });
    }

    function useCustomIcon() {
        const customIcon = document.getElementById('customIconInput').value.trim();
        if (customIcon) {
            selectIcon(customIcon);
        }
    }

    // Mevcut ikon seçiliyse başlangıçta seçili olarak başlat
    document.addEventListener('DOMContentLoaded', function() {
        const currentIcon = '@Model.Icon';
        if (currentIcon) {
            selectIcon(currentIcon);
        }
    });
</script>